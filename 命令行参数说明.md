# 命令行参数使用说明

本编辑器现在支持通过命令行参数打开文件并跳转到指定行号，就像 Notepad3 和其他专业编辑器一样。

## 支持的格式

### 1. Notepad3 风格（推荐用于外部工具集成）
```bash
editor.exe /g 行号 "文件路径"
```
或
```bash
editor.exe -g 行号 "文件路径"
editor.exe --goto 行号 "文件路径"
```

**示例：**
```bash
python main.py /g 100 "C:\path\to\file.txt"
python main.py -g 50 "example.cpp"
```

### 2. 通用编辑器风格（冒号分隔）
```bash
editor.exe "文件路径:行号"
```

**示例：**
```bash
python main.py "C:\path\to\file.txt:100"
python main.py "example.cpp:50"
```

### 3. 简单格式（空格分隔）
```bash
editor.exe "文件路径" 行号
```

**示例：**
```bash
python main.py "C:\path\to\file.txt" 100
python main.py "example.cpp" 50
```

### 4. 只打开文件（不跳转）
```bash
editor.exe "文件路径"
```

**示例：**
```bash
python main.py "C:\path\to\file.txt"
```

## 在外部工具中配置

### Visual Studio Code
在 settings.json 中配置外部编辑器：
```json
{
    "editor.external.program": "C:\\path\\to\\your\\editor.exe",
    "editor.external.args": ["/g", "{line}", "{file}"]
}
```

### Notepad3 兼容
如果你想替换 Notepad3，可以使用相同的命令行格式：
```batch
"C:\path\to\your\editor.exe" /g {line} "{file}"
```

### 其他 IDE 集成
大多数 IDE 都支持配置外部编辑器，通常支持以下占位符：
- `{file}` 或 `$FILE` - 文件路径
- `{line}` 或 `$LINE` - 行号

## 打包为 EXE 后使用

如果你已经使用 PyInstaller 将编辑器打包为 exe 文件，可以直接使用：

```batch
editor.exe /g 100 "C:\path\to\file.txt"
```

## 多文件打开

你也可以一次打开多个文件：

```bash
# 打开多个文件，每个文件都可以指定行号
python main.py file1.txt:10 file2.txt:20 file3.txt

# 或使用 /g 格式（只支持第一个文件）
python main.py /g 10 file1.txt file2.txt
```

## 注意事项

1. **路径处理**：
   - 相对路径会自动转换为绝对路径
   - 支持包含空格的路径（需要用引号括起来）

2. **行号范围**：
   - 如果指定的行号小于 1，会自动跳转到第 1 行
   - 如果指定的行号大于文件总行数，会自动跳转到最后一行

3. **文件检查**：
   - 只有存在的文件才会被打开
   - 不存在的文件会被静默忽略

4. **编码支持**：
   - 自动检测文件编码（UTF-8、GBK、Big5、Latin-1 等）
   - 保持原文件的行尾格式（CRLF、LF、CR）

## 测试示例

使用提供的 `open_with_line_example.bat` 文件测试各种格式：

```batch
REM 运行示例批处理文件
open_with_line_example.bat
```

## 与 Notepad3 对比

本编辑器完全兼容 Notepad3 的命令行格式：

| Notepad3 | 本编辑器 | 状态 |
|----------|---------|------|
| `/g line file` | ✅ 支持 | 完全兼容 |
| `/g line` (当前文件) | ❌ 不支持 | 需要指定文件 |
| `file` | ✅ 支持 | 完全兼容 |
| 多文件打开 | ✅ 支持 | 完全兼容 |

## 故障排除

### 跳转不工作？
- 确保行号是有效的数字
- 检查文件路径是否正确
- 查看控制台输出的错误信息

### 文件没有打开？
- 确认文件存在
- 检查文件路径中的特殊字符
- 确保有读取文件的权限

### 命令行参数解析错误？
- 确保使用了正确的格式
- 文件路径包含空格时使用引号
- 检查命令行中的转义字符
